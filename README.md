# How to write assembly code in Visual Studio 2019 for x86-64-mode
å¦‚ä½•åœ¨Visual Studio 2019ä¸‹å¯¹x86_64æ¨¡å¼ä½¿ç”¨æ±‡ç¼–è¯­è¨€

<br />

æœ¬åšæ–‡å°†è¯¦ç»†ä¸ºå¤§å®¶ä»‹ç»å¦‚ä½•åœ¨Visual Studio 2019ä¸­åˆ›å»ºä¸€ä¸ªåŒ…å«Cè¯­è¨€æºæ–‡ä»¶ä¸æ±‡ç¼–æºæ–‡ä»¶çš„é¡¹ç›®å·¥ç¨‹ï¼Œå¹¶èƒ½åœ¨Cæºæ–‡ä»¶ä¸­è°ƒç”¨æ±‡ç¼–è¯­è¨€å®ç°çš„è¿‡ç¨‹ï¼ˆprocedureï¼‰ã€‚
æœ¬é¡¹ç›®é‡‡ç”¨çš„æ˜¯æ–°å»ºä¸€ä¸ªæ§åˆ¶å°ç¨‹åºçš„å½¢å¼ã€‚å¦‚æœå„ä½åˆ›å»ºçš„æ˜¯Win32æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆè®¾ç½®è¿‡ç¨‹å…¶å®ä¹Ÿå·®ä¸å¤šã€‚ä¸‹é¢å¼€å§‹è¿›å…¥æ­£é¢˜ã€‚

<br />

æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚é¦–å…ˆæ‰“å¼€Visual Studio 2019ï¼ˆç¬”è€…ç”¨çš„æ˜¯communityç‰ˆæœ¬ï¼‰ã€‚åœ¨é¦–ç•Œé¢çš„å³ä¾§ï¼ˆâ€œå¼€å§‹ä½¿ç”¨â€ï¼‰ä¸€æ ç‚¹å‡»â€œåˆ›å»ºæ–°é¡¹ç›®â€ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚

![å›¾1](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/1.JPG)

<br />

éšåé€‰æ‹©â€œæ§åˆ¶å°åº”ç”¨â€ï¼Œå†ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œå¦‚å›¾2æ‰€ç¤ºï¼š

![å›¾2](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/2.JPG)

<br />

åœ¨â€œé…ç½®æ–°é¡¹ç›®â€ç•Œé¢ä¸­ï¼Œæˆ‘ä»¬å¡«ä¸Šè‡ªå·±æ‰€è¦åˆ›å»ºé¡¹ç›®çš„åç§°ï¼Œç„¶åé€‰æ‹©å­˜æ”¾é¡¹ç›®çš„è·¯å¾„ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¡¹ç›®è·¯å¾„åº”è¯¥ä»¥é¡¹ç›®åç§°ç»“å°¾ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å‹¾é€‰ä¸Šâ€œå°†è§£å†³æ–¹æ¡ˆå’Œé¡¹ç›®æ”¾åœ¨åŒä¸€ç›®å½•ä¸­â€ã€‚å¦‚å›¾3æ‰€ç¤ºï¼š

![å›¾3](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/3.JPG)

<br />

å®Œæˆä¹‹åæˆ‘ä»¬å°±è¿›å…¥äº†é¡¹ç›®ç¼–è¾‘ç•Œé¢ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°†é¡¹ç›®è‡ªåŠ¨ç”Ÿæˆçš„cppæºæ–‡ä»¶åˆ é™¤ï¼Œç„¶åæ–°å¢è‡ªå·±çš„Cæºæ–‡ä»¶å’Œæ±‡ç¼–æºæ–‡ä»¶ã€‚åœ¨Visual Studioä¸­ï¼Œæ±‡ç¼–æºæ–‡ä»¶ä¸€èˆ¬ä»¥ **.asm** ä½œä¸ºåç¼€åã€‚ç„¶åï¼Œæˆ‘ä»¬é€‰ä¸­â€œè§£å†³æ–¹æ¡ˆâ€ä¸‹æ–¹çš„é¡¹ç›®åã€‚å¦‚å›¾4æ‰€ç¤ºï¼š

![å›¾4](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/4.JPG)

<br />

éšåæˆ‘ä»¬é¼ æ ‡å³é”®ç‚¹å‡»é€‰ä¸­çš„é¡¹ç›®åï¼Œç„¶åé€‰æ‹©â€œç”Ÿæˆä¾èµ–é¡¹â€ä¸­çš„â€œç”Ÿæˆè‡ªå®šä¹‰â€ã€‚å¦‚å›¾5æ‰€ç¤ºï¼š

![å›¾5](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/5.JPG)

<br />

åœ¨æ‰€å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œæˆ‘ä»¬å‹¾é€‰ä¸Šâ€œmasmâ€è¿™ä¸€é¡¹å³å¯è®©å½“å‰é¡¹ç›®å·¥ç¨‹ä½¿ç”¨MASMæ±‡ç¼–å™¨ï¼Œå¦‚å›¾6æ‰€ç¤ºï¼Œå‹¾é€‰å®Œä¹‹åç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®å…³é—­å¯¹è¯æ¡†ã€‚

![å›¾6](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/6.JPG)

<br />

å®Œæˆä¹‹åï¼Œæˆ‘ä»¬åœ¨å·¥å…·æ ä¸­å°†å½“å‰å¹³å°è®¾ç½®ä¸ºâ€œ **x64** â€ï¼Œè¡¨ç¤ºå°†å½“å‰ç¨‹åºå˜ä¸ºä¸ºx86æ¶æ„çš„64ä½æ¨¡å¼ã€‚å¦‚å›¾7æ‰€ç¤ºï¼š

![å›¾7](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/7.JPG)

<br />

ç„¶åï¼Œæˆ‘ä»¬åœ¨èœå•æ ä¸­æ‰¾åˆ°â€œé¡¹ç›®â€ï¼Œç‚¹å‡»åå†é€‰æ‹©æœ€åçš„â€œå±æ€§â€é‚£ä¸€é¡¹ã€‚å¦‚å›¾8æ‰€ç¤ºï¼š

![å›¾8](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/8.JPG)

<br />

åœ¨å¼¹å‡ºçš„å±æ€§é¡µå¯¹è¯æ¡†ä¸­ï¼Œæˆ‘ä»¬å…ˆé€‰æ‹©â€œé…ç½®â€é¡¹çš„â€œæ‰€æœ‰é…ç½®â€ï¼Œç„¶åå³è¾¹çš„â€œå¹³å°â€é¡¹é»˜è®¤åº”è¯¥å·²ç»æ˜¯â€œæ´»åŠ¨(x64)â€ã€‚å±•å¼€å·¦ä¾§çš„â€œC/C++â€ï¼Œç‚¹å‡»â€œé¢„ç¼–è¯‘å¤´â€ï¼Œç„¶åå†ä¸­é—´â€œé¢„ç¼–è¯‘å¤´â€é‚£ä¸€é¡¹é€‰æ‹©â€œä¸ä½¿ç”¨é¢„ç¼–è¯‘å¤´â€ã€‚å¦‚å›¾9æ‰€ç¤ºï¼š

![å›¾9](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/9.JPG)

<br />

æ­¤æ—¶ï¼Œæˆ‘ä»¬å¦‚æœç›´æ¥ç‚¹å‡»å·¥å…·æ ä¸­ç»¿è‰²ä¸‰è§’ç®­å¤´æŒ‰é’®çš„è¯æ„å»ºå¯èƒ½ä¼šå¤±è´¥ï¼Œç”±äºæˆ‘ä»¬æ–°å¢çš„æ±‡ç¼–æºæ–‡ä»¶æ²¡æœ‰å‚ä¸ç¼–è¯‘ã€‚å¦‚æœç¢°åˆ°è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæˆ‘ä»¬é¼ æ ‡å³é”®ç‚¹å‡»æ±‡ç¼–æºæ–‡ä»¶ï¼Œç„¶åå†ç‚¹å‡»â€œå±æ€§â€é‚£ä¸€é¡¹ï¼Œå¦‚å›¾10æ‰€ç¤ºï¼š

![å›¾10](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/10.JPG)

<br />

æœ€åï¼Œæˆ‘ä»¬åœ¨â€œå¸¸è§„â€é¡¹ä¸­æ‰¾åˆ°â€œé¡¹ç±»å‹â€ï¼Œå†é€‰æ‹©â€œMicrosoft Macro Assemblerâ€ï¼Œè¿™å°±æ˜¯MASMçš„å…¨ç§°äº†ã€‚ğŸ˜„ å¦‚å›¾11æ‰€ç¤ºï¼š

![å›¾11](https://github.com/zenny-chen/How-to-write-assembly-code-in-Visual-Studio-2019-for-x86-64-mode/blob/master/11.JPG)

<br />

æœ¬æ•™ç¨‹æä¾›äº†å®Œæ•´çš„demoï¼Œå„ä½å¯ä»¥ä¸‹è½½è‡ªè¡Œæ„å»ºï¼Œæºä»£ç ä¹Ÿå¾ˆç®€å•ï¼Œä¾¿äºå­¦ä¹ ã€‚æœ€åé™„èµ å¾®è½¯å®˜æ–¹çš„x86_64æ¨¡å¼çš„å‡½æ•°è°ƒç”¨çº¦å®šï¼š[x64 calling convention](https://docs.microsoft.com/en-us/cpp/build/x64-calling-convention?view=vs-2019)ã€‚    
ä¸‹é¢å†æä¾›x86_64æ¨¡å¼ä¸‹çš„MASMæ–‡æ¡£ï¼š[MASM for x64 (ml64.exe)](https://docs.microsoft.com/en-us/cpp/assembler/masm/masm-for-x64-ml64-exe?view=vs-2019)ã€‚

<br />

### ä»¥ä¸‹æ˜¯å…³äºVisual Studioå·¥å…·æˆ–MSVCç¼–è¯‘å·¥å…·ç›¸å…³çš„èµ„æ–™

1. [Visual Studio 2019ä¸­ï¼Œç”¨äºè°ƒè¯•çš„å³æ—¶çª—å£](https://docs.microsoft.com/zh-cn/visualstudio/ide/reference/immediate-window?view=vs-2019)
2. [VCä½¿ç”¨CRTè°ƒè¯•åŠŸèƒ½æ£€æµ‹å†…å­˜æ³„æ¼](https://blog.csdn.net/lvwx369/article/details/41776965)
3. [Visual Studio 2019ä¹‹ä½ è¿˜åœ¨æ‰‹å·¥æ¸…ç†ä»£ç å—ï¼Ÿ](https://www.toutiao.com/i6760478177031619075/)

